# 2025-07-17 Effective Java 78~84 ì •ë¦¬

## ğŸ“š ê³µë¶€í•œ ë‚´ìš©  
ì´í™í‹°ë¸Œ ìë°” ì•„ì´í…œ 78~84 ì •ë¦¬ ë° ë™ì‹œì„± ìœ í‹¸ë¦¬í‹° ë¶„ì„

## ğŸ’¡ ì£¼ìš” ê°œë…ë“¤

### 78. ê³µìœ  ê°ì²´ì—ì„œëŠ” ë™ê¸°í™”ì— ì£¼ì˜í•˜ë¼
- ë©€í‹°ìŠ¤ë ˆë“œì—ì„œ ê³µìœ  ìì› ì ‘ê·¼ ì‹œ **ë™ê¸°í™”ëŠ” í•„ìˆ˜**ì´ë‹¤.
- ë™ê¸°í™”ëŠ” **ì›ìì„± ë³´ì¥**ë¿ ì•„ë‹ˆë¼ **ìŠ¤ë ˆë“œ ê°„ì˜ ê°€ì‹œì„±(ë³€ê²½ ì „íŒŒ)** ë³´ì¥ ëª©ì ë„ ìˆë‹¤.

```java
class StopThread {
    private static boolean stopRequested;

    public static void main(String[] args) {
        new Thread(() -> {
            while (!stopRequested) {
                // busy wait
            }
        }).start();

        Thread.sleep(1000);
        stopRequested = true; // ë°˜ì˜ë˜ì§€ ì•Šì„ ìˆ˜ ìˆìŒ!
    }
}
```

- í•´ê²°ì±…:
  - `volatile` ì‚¬ìš©: ì½ê¸° ì‹œ ì¼ê´€ì„± ë³´ì¥
  - `synchronized` ì‚¬ìš©: ì“°ê¸° ë™ê¸°í™”

---

### 79. ê³¼ë„í•œ ë™ê¸°í™”ëŠ” í”¼í•˜ë¼
- **ë½ì„ ì¡ì€ ì±„ë¡œ ì½œë°± í˜¸ì¶œ, ì™¸ë¶€ ë©”ì„œë“œ, I/O ê¸ˆì§€**
- êµì°© ìƒíƒœ, ë¬´í•œ ëŒ€ê¸° ë°œìƒ ê°€ëŠ¥
- `synchronized`ëŠ” ìµœì†Œí•œìœ¼ë¡œ, ë½ ë²”ìœ„ë¥¼ ì¢í˜€ë¼

```java
public void notifyElementAdded(E element) {
    List<SetObserver<E>> snapshot;
    synchronized(this) {
        snapshot = new ArrayList<>(observers);
    }
    for (SetObserver<E> observer : snapshot)
        observer.added(this, element); // ë½ ì—†ì´ ì•ˆì „í•˜ê²Œ í˜¸ì¶œ
}
```

---

### 80. Threadë³´ë‹¤ëŠ” Executor, Task, Streamì„ ì‚¬ìš©í•˜ë¼
- ì§ì ‘ `Thread` ì‚¬ìš©ì€ ë¹„ìš© ë†’ê³  ì œì–´ ì–´ë ¤ì›€
- `ExecutorService` ê°™ì€ **ê³ ìˆ˜ì¤€ API** ì‚¬ìš©
- ì˜ˆ:
```java
ExecutorService executor = Executors.newFixedThreadPool(4);
executor.submit(() -> { /* ì‘ì—… ë‚´ìš© */ });
executor.shutdown();
```
- ìŠ¤í”„ë§ì—ì„œëŠ” `@Async`, `ThreadPoolTaskExecutor` í™œìš©

---

### 81. waitì™€ notify ëŒ€ì‹  ë™ì‹œì„± ìœ í‹¸ë¦¬í‹° ì‚¬ìš©
#### 1. CountDownLatch
- ì—¬ëŸ¬ ì‘ì—… ì™„ë£Œ ëŒ€ê¸°
```java
CountDownLatch latch = new CountDownLatch(3);
// ì“°ë ˆë“œì—ì„œ ì‘ì—… í›„ countDown
latch.await(); // ëª¨ë“  ì‘ì—… ì™„ë£Œê¹Œì§€ ëŒ€ê¸°
```

#### 2. CyclicBarrier
- **ëª¨ë“  ìŠ¤ë ˆë“œê°€ ë„ë‹¬í•´ì•¼** ë‹¤ìŒ ë‹¨ê³„ë¡œ

#### 3. Semaphore
- ë™ì‹œì— ì ‘ê·¼ ê°€ëŠ¥í•œ ìŠ¤ë ˆë“œ ìˆ˜ ì œí•œ (ex. 30ëª… ë™ì‹œ ë‹¤ìš´ë¡œë“œ ì œí•œ)

#### 4. Phaser
- ë‹¨ê³„ë³„ ë™ê¸°í™” ì§€ì›, ìœ ì—°í•˜ê²Œ ì°¸ì—¬ì ìˆ˜ ì¡°ì ˆ

```java
Phaser phaser = new Phaser(3);
for (int i = 0; i < 3; i++) {
    new Thread(() -> {
        parse();
        phaser.arriveAndAwaitAdvance();

        compress();
        phaser.arriveAndAwaitAdvance();

        upload();
        phaser.arriveAndAwaitAdvance();
    }).start();
}
```

#### 5. BlockingQueue
- Kafka ì—†ì´ **ê°„ë‹¨í•œ ì´ë²¤íŠ¸ í êµ¬í˜„**
- í¬ê¸° ì œí•œ ì—†ì´ ì“°ë©´ ë©”ëª¨ë¦¬ í„°ì§ˆ ìˆ˜ ìˆìŒ

---

### 83. ì§€ì—° ì´ˆê¸°í™”ëŠ” ì •ì  í™€ë” í´ë˜ìŠ¤ ë°©ì‹ ì‚¬ìš©
```java
public class LazySingleton {
    private LazySingleton() {}
    private static class Holder {
        private static final LazySingleton INSTANCE = new LazySingleton();
    }
    public static LazySingleton getInstance() {
        return Holder.INSTANCE;
    }
}
```

- ì •ì  í•„ë“œ ì´ˆê¸°í™”ë³´ë‹¤ í´ë˜ìŠ¤ ë¡œë”© ì‹œì ì´ ì§€ì—°ë˜ì–´ ìœ ì—°ì„± í™•ë³´

---

## ğŸ”— ì°¸ê³ 
- ã€ŠEffective Javaã€‹ 3rd Edition
https://new-think-think.tistory.com/52
