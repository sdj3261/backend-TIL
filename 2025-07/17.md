---

title: "2025-07-17 TIL - Effective Java Item 78\~84"
date: 2025-07-17
category: TIL
tags: \[Java, Concurrency, Effective Java, Thread, Executor, Volatile]
----------------------------------------------------------------------

# Today I Learned

이 저장소는 제가 매일 학습한 내용을 기록하고 정리하기 위해 만든 공간입니다.
기술적인 개념, 실습하면서 마주친 문제들, 정리하고 싶은 개념들을 주제별/일자별로 구조화하여 관리하고 있습니다.

## 2025-07-17

### 📚 공부한 내용: Effective Java Item 78\~84

---

### 78. 공용 객체에서는 동기화에 주의해라

* 매우 개어하며 간각한 예제로, `stopRequested` 키가 `true`가 되어도 다른 스레드가 밝스가 되지 않아 루프를 빠지지 못한다.
* 값의 변경이 다른 스레드에 건너진다는 것을 가시성 (visibility)이라 함

```java
private static volatile boolean stopRequested = false;
```

* 객체에 있는 키가 변경이 될 경우,

  * `volatile`를 설정하면 키 변경이 다른 스레드에게 실제로 전화가 된다.

### 79. 과도한 동기화는 피해라

* `synchronized` 역시 다른 객체의 메서드를 호출할 때 결과 반영이 드문지지 않게 가능
* 예: 규칙을 반환해 `observers` 배열을 복사해서 호출

### 80. Thread 보다\uub294 Executor, Task, Stream을 사용해라

* 지적으로 `new Thread()` 정의는 제어 및 비용 문제
* `ExecutorService`, `@Async`, `ThreadPoolTaskExecutor`를 이용해 고수준 스링을 구현하라

```java
ExecutorService executor = Executors.newFixedThreadPool(4);
executor.submit(() -> doSomething());
executor.shutdown();
```

### 81. wait/notify 보다 동시성 유틸리티 활용

#### → 테스트와 순서 제어를 위해

* **CountDownLatch**: 여러 복사 작업 완료까지 대기
* **CyclicBarrier**: 여러 스레드가 같이 방향에 도착 후 차차이 진행
* **Semaphore**: 객체가 제공하는 객체가 일정 건수 이상 보조 가능 (e.g., 다운로드 30개)
* **Phaser**: 다른 단계 동기화 가능
* **BlockingQueue**: Kafka 같은 이벤트 관리 가능. 객체 크기에 의해 OOM 주의

### 83. 지연 초기화는 정적 필드보다 Holder 클래스 방식으로

```java
public class LazySingleton {
    private LazySingleton() {}

    private static class Holder {
        private static final LazySingleton INSTANCE = new LazySingleton();
    }

    public static LazySingleton getInstance() {
        return Holder.INSTANCE;
    }
}
```

* 정적 필드보다 실제 필드 필요 시점에 조건 없이 조건변수가 되면보다 안정적이며 반복 사용이 가능

---

### 🔗 참고

* Joshua Bloch, "Effective Java 3rd Edition"
* [https://docs.oracle.com/javase/tutorial/essential/concurrency/index.html](https://docs.oracle.com/javase/tutorial/essential/concurrency/index.html)
* [https://techblog.yogiyo.co.kr/concurrency-in-java/](https://techblog.yogiyo.co.kr/concurrency-in-java/)
