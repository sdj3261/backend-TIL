# [BE] 느려진 서비스 어디부터 봐야할까

**작성일:** 2025-06-15  
**출처:** 최범균님의 「주니어 백엔드 개발자가 반드시 알아야 할 실무 지식」

---

## 📌 서버 성능 핵심 지표

### 1. 응답시간
- 한 사용자의 요청을 처리하는 데 걸리는 시간
- 예시 흐름: 사용자 → API 서버 → DBMS → API 서버 → 사용자
- **TTFB**, **TTLB** 등을 사용해 측정
- 전체 처리 시간 중 DB 및 외부 API가 대부분 차지 → 이들 최적화 필요

### 2. 처리량 (Throughput)
- 단위 시간당 처리 가능한 작업 수
- **TPS (Transaction per Second)**, **RPS (Request per Second)** 지표 활용
- 초과 시 큐 대기 발생 → 처리 시간 증가

---

## 🔍 병목 지점 및 대응 전략

### 1. 수직 확장
- CPU, 메모리, 디스크 증설
- 단점: 비용 증가, 한계 존재

### 2. 수평 확장
- 서버 추가, 로드밸런싱
  - 정적 방식: IP 해시, 라운드 로빈 등
  - 동적 방식: 서버 상태 기반 분배
- 단, 외부 API/DB 성능 저하 시 무의미 → 병목 원인 정확히 파악

---

## 🔧 커넥션 풀 설정

1. **최소/최대 커넥션 수**
   - 시간대별 유동적 설정 가능
   - 급증 상황: 최소/최대 동일 설정 권장

2. **커넥션 획득 대기 시간**
   - 짧게 설정하여 빠른 응답 유도

3. **최대 유휴 시간, 유지 시간**
   - DB 커넥션 타임아웃보다 짧게 설정 필요
   - 유효성 검사, 커넥션 살아있는지 체크

---

## ⚙ 워커 스레드 설정 (Tomcat 기준)

- `minSpareThreads`: 대기 스레드 최소 수
- `maxThreads`: 동시에 처리할 최대 요청 수

---

## 🧠 캐시 전략

### 1. 캐시 계층
- 서버 캐시: DB 요청 없이 빠른 조회
- `Cache Hit Rate`로 효율 측정

### 2. 알고리즘
- **LRU**, **LFU**, TTL 기반 데이터 관리

### 3. 캐시 종류
- **로컬 캐시** (e.g. Caffeine)
  - 빠름, 서버 재시작 시 사라짐
- **리모트 캐시** (e.g. Redis)
  - 영속적, 네트워크 지연 있음

---

## 🧹 GC와 성능

### 1. G1GC
- 고정된 Region 단위로 가비지 수집
- 가비지가 많은 곳 먼저 수집 → STW 감소

### 2. ZGC
- STW 1~2ms 이하
- 백그라운드에서 병렬로 객체 관리

---

## 🌐 네트워크/압축 최적화

- **데이터 압축**: 텍스트만 효과적 (JSON, HTML)
- `Accept-Encoding`, `Content-Encoding` 활용

---

## 🖼 정적 리소스 & CDN

1. **Cache-Control 헤더**
   - 클라이언트 브라우저 캐시 활용

2. **CDN (CloudFront, Cloudflare)**
   - 이미지/정적 자산 캐싱
   - 서버 부하 및 네트워크 비용 절감

---
